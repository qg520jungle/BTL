<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="viewport" id="viewport" content="width=400">
  <meta name="keywords" content="模态框模板" />
  <meta name="description" content="模态框模板" />
  <title>首页</title>
  <link href="res/bootstrap.css" rel="stylesheet">
  <link href="res/btl-global.css" rel="stylesheet">
  <script src="lib/jquery.js"></script>
  <!--[if lte IE 9]>
  <script src="lib/respond.min.js"></script>
  <script src="lib/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="res/bootstrap.min.js"></script>
  <!--<link type="image/x-icon" href="favicon.ico" rel="shortcut icon" />-->
  <!--<link href="favicon.ico" rel="bookmark icon" />-->
  <style>
    ul>li>input{
      display: none;
    }
    ul>li>input.act{
      display: block;
    }
  </style>
</head>
<body>

  <!--弹出的模态框内容-->


     <div class="f-cb">
      <div class="f-fl">
       <div data-brackets-id="4705" class="f-fl">
        <div data-brackets-id="4706" class="m-table">
          <span data-brackets-id="4707">展具级别</span>
          <select data-brackets-id="4708" name="" id="">
            <option data-brackets-id="4709" value="A ">a </option>
          </select>
        </div>
        <div data-brackets-id="4710" class=" m-table">
          <table data-brackets-id="4711" class="table table-bordered">
            <thead data-brackets-id="4712">
              <tr data-brackets-id="4713">
                <th data-brackets-id="4714">
                  级别
                </th>
                <th data-brackets-id="4715">
                  总数
                </th>
              </tr>
            </thead>
            <tbody data-brackets-id="4716">
              <tr data-brackets-id="4717">
                <td data-brackets-id="4718">
                  A
                </td>
                <td data-brackets-id="4719">
                  1
                </td>
              </tr>
              <tr data-brackets-id="4720">
                <td data-brackets-id="4721">
                  B
                </td>
                <td data-brackets-id="4722">
                  2
                </td>
              </tr>
              <tr data-brackets-id="4723">
                <td data-brackets-id="4724">
                  C
                </td>
                <td data-brackets-id="4725">
                  3
                </td>
              </tr>
              <tr data-brackets-id="4726">
                <td data-brackets-id="4727">
                  D
                </td>
                <td data-brackets-id="4728">
                  4
                </td>
              </tr>
              <tr data-brackets-id="4729">
                <td data-brackets-id="4730">
                  E
                </td>
                <td data-brackets-id="4731">
                  5
                </td>
              </tr>
              <tr data-brackets-id="4732">
                <td data-brackets-id="4733">
                  V
                </td>
                <td data-brackets-id="4734">
                  6
                </td>
              </tr>
              <tr data-brackets-id="4735">
                <td data-brackets-id="4736">
                  新能源
                </td>
                <td data-brackets-id="4737">
                  7
                </td>
              </tr>
              <tr data-brackets-id="4738">
                <td data-brackets-id="4739">
                  总计
                </td>
                <td data-brackets-id="4740">
                  28
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div></div>
      <div class="f-fl">
      <div class=" m-lgifram">
         <div class="modal-header">
            <button type="button" class="close j-close" data-dismiss="modal"
               aria-hidden="true">×
            </button>
            <h4 class="modal-title" id="myModalLabel">
               选择车源
            </h4>
         </div>
         <div class="modal-body  f-cb">
           <div class="m-c2nd">
           <div class="container-fluid">
            <div class="row">
               <dl class="col-md-4 u-dl">
              <dt class="large">品牌：</dt>
              <dd>
                <input type="text" class="u-input u-input-normal">
              </dd>
            </dl>
            <dl class="col-md-4 u-dl">
              <dt class="large">车系：</dt>
              <dd>
                <input type="text" class="u-input u-input-normal">
              </dd>
            </dl>
            <dl class="col-md-4 u-dl">
              <dt class="large">车型：</dt>
              <dd>
                <input type="text" class="u-input u-input-normal">
              </dd>
            </dl>
            <dl class="col-md-4 u-dl">
              <dt class="large">发动机排量：</dt>
              <dd>
                <input type="text" class="u-input u-input-normal">
              </dd>
            </dl>
            <dl class="col-md-4 u-dl">
              <dt class="large">行驶里程：</dt>
              <dd>
                <input type="text" class="u-input u-input-normal">
              </dd>
            </dl>
            <dl class="col-md-4 u-dl">
              <dt class="large">日期：</dt>
              <dd>
                <input type="text" class="u-input u-input-small"><span class="s-fs-s"> ——</span>
                <input type="text" class="u-input u-input-small">
              </dd>
            </dl>
               </div>
               </div>

            <div class="m-btn-box f-fr col-md-3">
              <a href="javascript" class="u-btn btn btn-normal btn-main">搜索</a> <a href="javascript" class="u-btn btn btn-normal btn-white">取消</a>
            </div>
          </div>
     <div class="m-table f-cb">
            <table class="table table-bordered">
              <tr>
                <th>选择</th>
                <th>品牌</th>
                <th>车系</th>
                <th class="w-10">车型名称</th>
                <th>车牌号码</th>
                <th>车身颜色</th>
                <th>出厂日期</th>
                <th>购买时间</th>
                <th>行驶里程</th>
                <th>销售定价</th>
              </tr>
              <tr>
                <td><input type="checkbox" i-data="i1" class="j-cb"></td>
                <td>日产</td>
                <td>轩逸</td>
                <td>2.0 XV CVT Prem 豪华版</td>
                <td>粤A:888888</td>
                <td>白色</td>
                <td>2015/12/31</td>
                <td>2015/12/31</td>
                <td>3000miles</td>
                <td>250000元</td>
              </tr>
              <tr>
                <td><input type="checkbox" i-data="i2" class="j-cb"></td>
                <td>日产</td>
                <td>轩逸</td>
                <td>2.0 XV CVT Prem 豪华版</td>
                <td>粤A:888888</td>
                <td>白色</td>
                <td>2015/12/31</td>
                <td>2015/12/31</td>
                <td>3000miles</td>
                <td>250000元</td>
              </tr>
              <tr>
                <td><input type="checkbox" i-data="i3" class="j-cb"></td>
                <td>日产</td>
                <td>轩逸</td>
                <td>2.0 XV CVT Prem 豪华版</td>
                <td>粤A:888888</td>
                <td>白色</td>
                <td>2015/12/31</td>
                <td>2015/12/31</td>
                <td>3000miles</td>
                <td>250000元</td>
              </tr>
               </table>
            <div class="f-fr">
              <nav>
                <ul class="pagination">
                  <li>
                    <a href="#" aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                  </li>
                  <li class="active"><a href="#">1</a></li>
                  <li><a href="#">2</a></li>
                  <li><a href="#">3</a></li>
                  <li><a href="#">4</a></li>
                  <li><a href="#">5</a></li>
                  <li>
                    <a href="#" aria-label="Next">
                      <span aria-hidden="true">&raquo;</span>
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
            </div>
            <div class="m-check-list">
              <ul class="j-list f-cb">
                <li>
                  <span>ID:...</span><span class="u-x">×
            </span>
                </li>
              </ul>
            </div>
         </div>
         <div class="modal-footer">
           <button type="button" class="btn btn-default test"
               data-dismiss="modal">测试
            </button>
            <button type="button" class="btn btn-default j-close"
               data-dismiss="modal">关闭
            </button>
            <button type="button" class="btn btn-primary j-submit">
               提交
            </button>
            <button type="button" class="btn btn-primary j-reset">
               刷新
            </button>
         </div>
      </div><!-- /.modal-content -->
    </div>
   </div><!-- /.modal-dialog -->

  <!--modal-->

    <script>
      var arr=[];
      var $ifram=$('.j-iframe', window.parent.document);
      var $pop=$ifram.parent();
      var $cover=$ifram.parent().parent().find('.j-cover');
      var $input=$ifram.parents('body').find('.j-input');
      var $data1=$ifram.parents('body').find('.j-data1');
      var $data2=$ifram.parents('body').find('.j-data2');
     /* console.log($ifram)*/
      function toArr(str){
        var arr=[]
        arr=str.split(",")
        return arr
      }
      function toStr(arr){
        var str='';
        str=arr.join(',');
        return str
      }
      arr=toArr($data1.val());
      //加载数组内容到table
      function loadList(arr){
        $('[i-data]').each(function(index,el){
          el.checked=false;
        })
        for(var i=0;i<arr.length;i++){
            if($('[i-data='+arr[i]+']')){
              $('[i-data='+arr[i]+']').get(0).checked=true;
            }
        }
      }
      loadList(arr);
      //数组添加
      function addArr(_id){
        arr.push(_id);
      }
      //数组删除
      function divArr(_id){
        for(var i=0;i<arr.length;i++){
          if(arr[i]==_id){
            arr.splice(i,1);
          }
        }
      }
      //显示区加载
      function blockShow(arr){
        s='';
        for(var i=0;i<arr.length;i++){
          s+='<li b-data="'+arr[i]+'">'
          s+='<span>ID:'+arr[i]+'</span><span class="u-x j-x" >×</span>'
          s+='</li>'
        }
        $('.j-list').html('');
        $('.j-list').append(s);
        delClick();
      }
      blockShow(arr);
      //添加点击事件
      function delClick(){
        $('.j-x').on('click',function(){
          var _id=$(this).parent().attr('b-data');
          divArr(_id);
          console.log(arr);
          loadList(arr);
          blockShow(arr);
        });
      }
      //添加选择事件
      $('.j-cb').on('click',function(){
        if($(this).get(0).checked===true){
          var _id=$(this).attr('i-data');
          addArr(_id);
          blockShow(arr);
        }else{
          var _id2=$(this).attr('i-data');
          divArr(_id2);
          blockShow(arr);
        }
      })
      //取消恢复未修改状态
      $('.j-close').on('click',function(){
        $input.val($data1.val());
        $pop.hide();
        $cover.hide();
      });

      //提交赋值到父页面
      $('.j-submit').on('click',function(){
        var str='';
        str=toStr(arr)
        $input.val(str)
        $data1.val(str)
        $pop.hide();
        $cover.hide();
      });
      $('.j-reset').on('click',function(){
        $ifram.attr('src', 'http://www.baidu.com');
      });
    </script>
    </body>
</html>
